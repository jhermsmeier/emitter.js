function Emitter(){this._events=this._events||{},this._maxListeners=10,this._memLeakDetected=!1}"undefined"!=typeof module&&(module.exports=Emitter),Emitter.nextTick="undefined"!=typeof process&&"function"==typeof process.nextTick?process.nextTick.bind(process):setTimeout.bind(this),Emitter.warn=!0,Emitter.prototype={on:function(a,b){if("function"!=typeof b)throw new TypeError("Handler must be a function.");return this._events[a]?this._events[a].push(b):this._events[a]=[b],Emitter.warn&&this._events[a].length>this._maxListeners&&this._maxListeners>0&&!this._memLeakDetected&&(this._memLeakDetected=!0,console.warn("WARNING: Possible event emitter memory leak detected.",this._events[a].length,"event handlers added.","Use emitter.setMaxListeners() to increase the threshold."),console.trace()),this},once:function(a,b){function c(){this.removeListener(a,c),b.apply(this,arguments)}if("function"!=typeof b)throw new TypeError("Handler must be a function.");return this._events[a]?this._events[a].push(c):this._events[a]=[c],this},emit:function(a){var c=this._events[a];if("error"!==a||c){if(!c)return!1}else if(!this._events.error)throw arguments[1]instanceof Error?arguments[1]:new TypeError('Unhandled "error" event.');var e,d=[].slice.call(arguments,1),f=c.length;for(e=0;f>e;e++)Emitter.nextTick(function(a){a.apply(this,d)}.bind(this,c[e]));return!0},emitSync:function(a){var c=this._events[a];if("error"!==a||c){if(!c)return!1}else if(!this._events.error)throw arguments[1]instanceof Error?arguments[1]:new TypeError('Unhandled "error" event.');var e,d=[].slice.call(arguments,1),f=c.length;for(e=0;f>e;e++)c[e].apply(this,d);return!0},listeners:function(a){return this._events[a]?this._events[a].slice():[]},setMaxListeners:function(a){if("number"!=typeof a)throw new TypeError("Value must be a number.");return this._maxListeners=a,this},removeListener:function(a,b){if("function"!=typeof b)throw new TypeError("Handler must be a function.");var c=this._events[a],d=c.indexOf(b);return c&&~d&&(1===c.length?(this._events[a]=void 0,delete this._events[a]):c.splice(d,1)),this},removeAllListeners:function(a){if(0===arguments.length)for(a in this._events)this.removeAllListeners(a);else this._events[a]=void 0,delete this._events[a];return this}};